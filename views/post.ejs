<%- include('partials/header') %>

<div class="container">
    <article class="blog-post">
        <header class="post-header">
            <nav class="breadcrumb">
                <a href="/">
                    <i class="fas fa-home"></i>
                    Home
                </a>
                <span class="breadcrumb-separator">/</span>
                <span class="breadcrumb-current"><%= post.title %></span>
            </nav>
            
            <h1 class="post-title"><%= post.title %></h1>
            
            <div class="post-meta">
                <div class="meta-item">
                    <i class="fas fa-user"></i>
                    <span>By <%= post.author %></span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-calendar"></i>
                    <span><%= new Date(post.date).toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    }) %></span>
                </div>
                <div class="meta-item">
                    <i class="fas fa-clock"></i>
                    <span><%= Math.ceil(post.content.split(' ').length / 200) %> min read</span>
                </div>
            </div>
        </header>

        <div class="post-content">
            <div class="content-text">
                <%= post.content %>
            </div>
        </div>

        <footer class="post-footer">
            <% if (isAuthenticated) { %>
            <div class="post-management">
                <div class="management-buttons">
                    <a href="/post/<%= post.id %>/edit" class="btn-edit">
                        <i class="fas fa-edit"></i>
                        Edit Post
                    </a>
                    <button class="btn-delete" data-post-id="<%= post.id %>">
                        <i class="fas fa-trash"></i>
                        Delete Post
                    </button>
                </div>
            </div>
            <% } %>

            <div class="share-section">
                <h4>Share this post:</h4>
                <div class="share-buttons">
                    <a href="#" class="share-btn twitter" onclick="shareOnTwitter()">
                        <i class="fab fa-twitter"></i>
                        Twitter
                    </a>
                    <a href="#" class="share-btn facebook" onclick="shareOnFacebook()">
                        <i class="fab fa-facebook"></i>
                        Facebook
                    </a>
                    <a href="#" class="share-btn linkedin" onclick="shareOnLinkedIn()">
                        <i class="fab fa-linkedin"></i>
                        LinkedIn
                    </a>
                    <button class="share-btn copy" onclick="copyLink()">
                        <i class="fas fa-link"></i>
                        Copy Link
                    </button>
                </div>
            </div>
            
            <div class="navigation-section">
                <a href="/" class="back-to-home">
                    <i class="fas fa-arrow-left"></i>
                    Back to All Posts
                </a>
            </div>
        </footer>
    </article>
</div>

<script>
    function deletePost(postId) {
        if (confirm('Are you sure you want to delete this post? This action cannot be undone.')) {
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = `/post/${postId}/delete`;
            document.body.appendChild(form);
            form.submit();
        }
    }

    function shareOnTwitter() {
        const url = window.location.href;
        const text = '<%= post.title %>';
        window.open(`https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(text)}`, '_blank');
    }

    function shareOnFacebook() {
        const url = window.location.href;
        window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`, '_blank');
    }

    function shareOnLinkedIn() {
        const url = window.location.href;
        const title = '<%= post.title %>';
        window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}`, '_blank');
    }

    function copyLink() {
        navigator.clipboard.writeText(window.location.href).then(() => {
            const btn = event.target.closest('.copy');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
            setTimeout(() => {
                btn.innerHTML = originalText;
            }, 2000);
        });
    }
</script>

<%- include('partials/footer') %>